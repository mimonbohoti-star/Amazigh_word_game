<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Tahoma, Arial, sans-serif;
  background: #111;
  color: #fff;
  text-align: center;
}

.stage {
  padding: 20px;
}

.word-box {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 25px 0;
  direction: ltr;
}

.letter {
  width: 45px;
  height: 55px;
  font-size: 28px;
  text-align: center;
  border-radius: 6px;
  border: 2px solid #555;
  background: #222;
  color: #fff;
}

.correct {
  border-color: #2ecc71;
  background: #1e7e34;
}

.wrong {
  border-color: #e74c3c;
  background: #922b21;
}

.word-box.shake {
  animation: shake 0.4s;
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  50% { transform: translateX(5px); }
  75% { transform: translateX(-5px); }
  100% { transform: translateX(0); }
}

button {
  padding: 10px 25px;
  border: none;
  border-radius: 6px;
  background: #3498db;
  color: #fff;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="stage">
  <h2 id="levelInfo"></h2>

  <div class="word-box" id="wordBox"></div>

  <div id="message">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©</div>

  <br>
  <button onclick="nextLevel()">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
</div>

<script>
const levels = [
  { answer: "AZUL" },
  { answer: "AMUR" },
  { answer: "TAFSUT" }
];

let currentLevel = Number(localStorage.getItem("amazighLevel")) || 0;
let inputs = [];

function loadLevel() {
  const wordBox = document.getElementById("wordBox");
  wordBox.innerHTML = "";
  inputs = [];

  document.getElementById("message").textContent = "Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©";
  document.getElementById("levelInfo").textContent =
    "Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + (currentLevel + 1);

  const answer = levels[currentLevel].answer;

  for (let i = 0; i < answer.length; i++) {
    const input = document.createElement("input");
    input.maxLength = 1;
    input.className = "letter";

    input.addEventListener("input", () => handleInput(i));
    input.addEventListener("keydown", e => handleBackspace(e, i));

    inputs.push(input);
    wordBox.appendChild(input);
  }

  inputs[0].focus();
}

function handleInput(index) {
  inputs[index].value = inputs[index].value.toUpperCase();

  if (inputs[index].value && index < inputs.length - 1) {
    inputs[index + 1].focus();
  }

  checkWord();
}

function handleBackspace(e, index) {
  if (e.key === "Backspace" && !inputs[index].value && index > 0) {
    inputs[index - 1].focus();
  }
}

function resetStyles() {
  inputs.forEach(i => {
    i.classList.remove("correct", "wrong");
  });
}

function checkWord() {
  const answer = levels[currentLevel].answer;
  const userWord = inputs.map(i => i.value).join("");

  if (userWord.length < answer.length) return;

  resetStyles();

  if (userWord === answer) {
    inputs.forEach(i => i.classList.add("correct"));
    document.getElementById("message").textContent = "âœ” ØµØ­ÙŠØ­";
    localStorage.setItem("amazighLevel", currentLevel + 1);
  } else {
    inputs.forEach(i => i.classList.add("wrong"));
    const box = document.getElementById("wordBox");
    box.classList.add("shake");
    setTimeout(() => box.classList.remove("shake"), 400);
    document.getElementById("message").textContent = "âœ– Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";
  }
}

function nextLevel() {
  if (currentLevel < levels.length - 1) {
    currentLevel++;
    loadLevel();
  } else {
    document.getElementById("message").textContent = "ðŸŽ‰ ÙƒÙ…Ù„Øª Ø§Ù„Ù„Ø¹Ø¨Ø©";
  }
}

loadLevel();
</script>

</body>
</html>
