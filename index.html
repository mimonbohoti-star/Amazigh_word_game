<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>âµ£ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{--accent:#facc15}
body{
 margin:0;font-family:sans-serif;
 background:radial-gradient(circle at top,#1e293b,#020617);
 color:#fff;display:flex;justify-content:center;align-items:center;min-height:100vh;
}
.card{
 width:95%;max-width:420px;background:#020617;border-radius:26px;
 padding:22px;box-shadow:0 0 0 2px var(--accent),0 30px 60px rgba(0,0,0,.7);
}
h1{text-align:center;color:var(--accent)}
.section{display:none}
.section.active{display:block}

.btn{
 width:100%;min-height:52px;margin:8px 0;border:none;border-radius:16px;
 font-size:18px;font-weight:700;cursor:pointer
}
.btn-main{background:var(--accent);color:#000}
.btn-ok{background:#22c55e;color:#000}
.btn-back{background:#0f172a;color:#fff;border:1px solid #334155}
.btn-del{background:#ef4444;color:#fff}

.map{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.stage{
 background:#111827;border-radius:16px;padding:20px;text-align:center;
 font-weight:bold
}
.stage.locked{opacity:.3}
.stage.active{background:var(--accent);color:#000;cursor:pointer}

.answer-boxes{
 display:flex;justify-content:center;gap:8px;margin:12px 0;
 direction:ltr;
}
.answer-box{
 width:44px;height:44px;border-radius:10px;background:#fff;color:#000;
 display:flex;align-items:center;justify-content:center;font-size:22px
}
.answer-box.ok{background:#22c55e}
.answer-box.bad{background:#ef4444;color:#fff}

/* ===== KEYBOARD ===== */
.keyboard{
 display:grid;grid-template-columns:repeat(6,1fr);gap:8px;
 direction:ltr;
}
.key{
 background:#1e293b;padding:12px;border-radius:12px;
 text-align:center;font-size:20px;cursor:pointer
}
.key.used{opacity:.3;pointer-events:none}

/* ===== SWIPE ===== */
.swipe{
 width:260px;height:260px;margin:20px auto;
 border-radius:50%;border:3px solid var(--accent);
 position:relative;touch-action:none;
}
.swipe .key{
 width:52px;height:52px;border-radius:50%;
 background:var(--accent);color:#000;
 position:absolute;display:flex;
 align-items:center;justify-content:center;
 font-weight:bold;font-size:22px
}
.swipe .key.active{background:#22c55e}
svg{position:absolute;inset:0}

/* ===== WIN ===== */
.overlay{
 position:fixed;inset:0;background:rgba(0,0,0,.95);
 display:none;justify-content:center;align-items:center
}
.overlay.active{display:flex}
.win{
 background:#020617;padding:28px;border-radius:24px;
 box-shadow:0 0 60px var(--accent);
}
</style>
</head>

<body>

<div class="card">

<div id="menu" class="section active">
 <h1>âµ£ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</h1>
 <button class="btn btn-main" onclick="openMap()">â–¶ï¸ Ø¨Ø¯Ø¡</button>
</div>

<div id="map" class="section">
 <h1>â­ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</h1>
 <div class="map" id="mapGrid"></div>
 <button class="btn btn-back" onclick="show('menu')">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
</div>

<div id="game" class="section">
 <h1 id="levelTitle"></h1>
 <div id="question"></div>
 <div class="answer-boxes" id="boxes"></div>

 <div id="swipeArea"></div>
 <div id="keyboard" class="keyboard"></div>

 <button class="btn btn-del" onclick="del()">âŒ« Ø­Ø°Ù</button>
 <button class="btn btn-ok" onclick="check()">âœ”ï¸ ØªØ£ÙƒÙŠØ¯</button>
</div>

</div>

<div id="overlay" class="overlay">
 <div class="win">
  <h2>ğŸ”¥ Ø£Ø­Ø³Ù†Øª ğŸ”¥</h2>
  <button class="btn btn-main" onclick="next()">â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
 </div>
</div>

<script>
const levels=[
 {img:"images/sun.jpg",a:"âµœâ´°â´¼âµ“âµ¢âµœ",c:"#facc15",swipe:true},
 {img:"images/moon.jpg",a:"â´°âµ¢âµ“âµ”",c:"#60a5fa"},
 {img:"images/stars.jpg",a:"âµ‰âµœâµ”â´°âµ",c:"#e9d5ff"},
 {img:"images/mountain.jpg",a:"â´°â´·âµ”â´°âµ”",c:"#34d399"},
 {img:"images/river.jpg",a:"â´°âµ™âµ‰â´¼",c:"#38bdf8"}
];

let cur=0,input=[],used=[];

function show(id){
 document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
}

function openMap(){
 mapGrid.innerHTML="";
 levels.forEach((_,i)=>{
  let d=document.createElement("div");
  d.className="stage active";
  d.innerText="Ù…Ø±Ø­Ù„Ø© "+(i+1);
  d.onclick=()=>start(i);
  mapGrid.appendChild(d);
 });
 show("map");
}

function start(i){
 cur=i;input=[];used=[];
 document.documentElement.style.setProperty("--accent",levels[i].c);
 levelTitle.innerText="Ø§Ù„Ù…Ø±Ø­Ù„Ø© "+(i+1);
 question.innerHTML=`<img src="${levels[i].img}" width="100%">`;
 boxes.innerHTML="";keyboard.innerHTML="";swipeArea.innerHTML="";
 [...levels[i].a].forEach(()=>boxes.innerHTML+=`<div class="answer-box"></div>`);

 if(levels[i].swipe) buildSwipe();
 else buildKeyboard();

 show("game");
}

function buildKeyboard(){
 keyboard.style.display="grid";
 swipeArea.style.display="none";
 [...levels[cur].a].sort(()=>Math.random()-.5).forEach(ch=>{
  let k=document.createElement("div");
  k.className="key";k.innerText=ch;
  k.onclick=()=>add(ch,k);
  keyboard.appendChild(k);
 });
}

function buildSwipe(){
 keyboard.style.display="none";
 swipeArea.style.display="block";

 let wrap=document.createElement("div");
 wrap.className="swipe";
 wrap.innerHTML=`<svg><path stroke="white" stroke-width="6" fill="none"/></svg>`;
 let path=wrap.querySelector("path");
 let r=100,d="",drawing=false;

 [...levels[cur].a].forEach((ch,n)=>{
  let k=document.createElement("div");
  k.className="key";k.innerText=ch;
  let a=n/levels[cur].a.length*2*Math.PI;
  k.style.left=130+r*Math.cos(a)-26+"px";
  k.style.top =130+r*Math.sin(a)-26+"px";
  wrap.appendChild(k);
 });

 wrap.addEventListener("touchstart",e=>{
  drawing=true;d="";path.setAttribute("d","");
  input=[];used=[];
  wrap.querySelectorAll(".key").forEach(k=>k.classList.remove("active"));
 });

 wrap.addEventListener("touchmove",e=>{
  if(!drawing)return;
  let t=e.touches[0],rct=wrap.getBoundingClientRect();
  let x=t.clientX-rct.left,y=t.clientY-rct.top;
  d+=d===""?`M${x},${y}`:` L${x},${y}`;
  path.setAttribute("d",d);

  wrap.querySelectorAll(".key").forEach(k=>{
   let b=k.getBoundingClientRect();
   if(t.clientX>b.left&&t.clientX<b.right&&t.clientY>b.top&&t.clientY<b.bottom&&!used.includes(k)){
    used.push(k);k.classList.add("active");
    input.push(k.innerText);refresh();
   }
  });
 });

 wrap.addEventListener("touchend",()=>drawing=false);
 swipeArea.appendChild(wrap);
}

function add(ch,key){
 if(input.length<levels[cur].a.length){
  input.push(ch);key.classList.add("used");refresh();
 }
}

function del(){input.pop();refresh();}

function refresh(){
 document.querySelectorAll(".answer-box").forEach((b,i)=>b.innerText=input[i]||"");
}

function check(){
 if(input.join("")===levels[cur].a)overlay.classList.add("active");
}

function next(){
 overlay.classList.remove("active");
 show("menu");
}
</script>

</body>
</html>
