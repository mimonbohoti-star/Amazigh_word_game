<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>شبكة السحب</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: linear-gradient(#0f3d3d, #4fa3a3);
  font-family: sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.grid {
  display: grid;
  grid-template-columns: repeat(7, 45px);
  gap: 8px;
  touch-action: none; /* مهم للسحب */
}

.cell {
  width: 45px;
  height: 45px;
  background: #1e2f2f;
  border-radius: 8px;
}

.cell.active {
  background: #5ecbff;
}
</style>
</head>

<body>

<div class="grid" id="grid"></div>

<script>
const grid = document.getElementById("grid");
const size = 7;
let cells = [];
let isDragging = false;
let startCell = null;
let direction = null;

// إنشاء الشبكة
for (let i = 0; i < size * size; i++) {
  const cell = document.createElement("div");
  cell.className = "cell";
  cell.dataset.index = i;
  grid.appendChild(cell);
  cells.push(cell);
}

// أدوات
function getRow(index) {
  return Math.floor(index / size);
}
function getCol(index) {
  return index % size;
}
function clearSelection() {
  cells.forEach(c => c.classList.remove("active"));
}

// بداية السحب
cells.forEach(cell => {
  cell.addEventListener("pointerdown", e => {
    clearSelection();
    isDragging = true;
    startCell = cell;
    direction = null;
    cell.classList.add("active");
    cell.setPointerCapture(e.pointerId);
  });

  cell.addEventListener("pointerenter", () => {
    if (!isDragging) return;

    const startIndex = +startCell.dataset.index;
    const currentIndex = +cell.dataset.index;

    const sr = getRow(startIndex);
    const sc = getCol(startIndex);
    const cr = getRow(currentIndex);
    const cc = getCol(currentIndex);

    // تحديد الاتجاه
    if (!direction) {
      if (sr === cr) direction = "row";
      else if (sc === cc) direction = "col";
      else return;
    }

    clearSelection();

    if (direction === "row" && sr === cr) {
      const min = Math.min(sc, cc);
      const max = Math.max(sc, cc);
      for (let c = min; c <= max; c++) {
        cells[sr * size + c].classList.add("active");
      }
    }

    if (direction === "col" && sc === cc) {
      const min = Math.min(sr, cr);
      const max = Math.max(sr, cr);
      for (let r = min; r <= max; r++) {
        cells[r * size + sc].classList.add("active");
      }
    }
  });

  cell.addEventListener("pointerup", () => {
    isDragging = false;
    startCell = null;
    direction = null;
  });
});
</script>

</body>
</html>
