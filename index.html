<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>لعبة الكلمات الأمازيغية</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap');

body {
  margin: 0;
  font-family: 'Cairo', sans-serif;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  color: #fff;
  text-align: center;
}

.hidden { display: none; }

#startScreen, #gameScreen {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

h1 { font-size: 36px; }

button {
  border: none;
  padding: 14px 36px;
  border-radius: 40px;
  font-size: 18px;
  cursor: pointer;
  font-family: 'Cairo', sans-serif;
}

#startBtn {
  background: linear-gradient(45deg, #56ccf2, #2f80ed);
  color: #000;
}

#nextBtn {
  background: linear-gradient(45deg, #6fcf97, #27ae60);
  margin-top: 25px;
  color: #000;
}

#topBar {
  display: flex;
  justify-content: space-between;
  width: 90%;
  max-width: 420px;
  margin-bottom: 15px;
}

#answer {
  font-size: 30px;
  letter-spacing: 8px;
  margin: 15px 0;
}

.keys {
  display: grid;
  grid-template-columns: repeat(5, 60px);
  gap: 12px;
}

.key {
  background: #1c2b30;
  border-radius: 16px;
  padding: 16px;
  font-size: 22px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.3);
  transition: 0.15s;
}

.key:active { transform: scale(0.95); }

.key.active {
  background: linear-gradient(45deg, #56ccf2, #2f80ed);
  color: #000;
}
</style>
</head>

<body>

<div id="startScreen">
  <h1>ⵣ لعبة الكلمات الأمازيغية ⵣ</h1>
  <button id="startBtn">ابدأ اللعب</button>
</div>

<div id="gameScreen" class="hidden">
  <div id="topBar">
    <div id="levelInfo"></div>
    <div id="scoreInfo">⭐ 0</div>
  </div>

  <div id="question"></div>
  <div id="answer"></div>
  <div class="keys" id="keys"></div>
  <button id="nextBtn" class="hidden">التالي</button>
</div>

<script>
/* ====== مؤثرات ====== */
const clickSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-click-1110.mp3");
const successSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3");

function vibrate(ms = 30) {
  if (navigator.vibrate) navigator.vibrate(ms);
}

/* ====== اللعبة ====== */
const levels = [
  [
    { q: "حيوان أليف", a: "ⴰⵣⵓ" },
    { q: "لون السماء", a: "ⴰⵣⵔ" }
  ],
  [
    { q: "الماء", a: "ⴰⵎⴰⵏ" },
    { q: "النار", a: "ⴰⴼⵓ" }
  ],
  [
    { q: "الشمس", a: "ⵜⴰⴼⵓⵢⵜ" },
    { q: "القمر", a: "ⴰⵢⵓⵔ" }
  ]
];

let level = Number(localStorage.getItem("level")) || 0;
let score = Number(localStorage.getItem("score")) || 0;
let index = 0;
let answer = "";
let current = {};

const startScreen = document.getElementById("startScreen");
const gameScreen = document.getElementById("gameScreen");
const questionEl = document.getElementById("question");
const answerEl = document.getElementById("answer");
const keysEl = document.getElementById("keys");
const nextBtn = document.getElementById("nextBtn");
const levelInfo = document.getElementById("levelInfo");
const scoreInfo = document.getElementById("scoreInfo");

document.getElementById("startBtn").onclick = () => {
  startScreen.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  updateScore();
  loadQuestion();
};

nextBtn.onclick = () => {
  index++;
  if (index >= levels[level].length) {
    level++;
    index = 0;
    localStorage.setItem("level", level);
    if (!levels[level]) {
      alert("مبروك! كملتي اللعبة ⭐");
      level = 0;
      score = 0;
      localStorage.setItem("level", 0);
      localStorage.setItem("score", 0);
    }
  }
  loadQuestion();
};

function loadQuestion() {
  current = levels[level][index];
  answer = "";
  levelInfo.textContent = `المرحلة ${level + 1}`;
  questionEl.textContent = current.q;
  answerEl.textContent = "◦ ".repeat(current.a.length);
  nextBtn.classList.add("hidden");
  renderKeys(shuffle(current.a.split("").concat(extraLetters())));
}

function renderKeys(chars) {
  keysEl.innerHTML = "";
  chars.forEach(c => {
    const k = document.createElement("div");
    k.className = "key";
    k.textContent = c;
    k.onclick = () => pressKey(c, k);
    keysEl.appendChild(k);
  });
}

function pressKey(c, el) {
  if (answer.length >= current.a.length) return;

  clickSound.currentTime = 0;
  clickSound.play();
  vibrate(20);

  answer += c;
  el.classList.add("active");
  answerEl.textContent = answer.split("").join(" ");

  if (answer === current.a) {
    successSound.play();
    vibrate(80);
    score += 10;
    localStorage.setItem("score", score);
    updateScore();
    nextBtn.classList.remove("hidden");
  }
}

function updateScore() {
  scoreInfo.textContent = `⭐ ${score}`;
}

function extraLetters() {
  return ["ⴱ","ⴷ","ⴳ","ⵎ","ⵙ","ⵣ"];
}

function shuffle(a) {
  return a.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>
