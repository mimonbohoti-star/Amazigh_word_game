<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© â€“ Ù†Ù‚Ø§Ø· ÙˆÙ…Ø¤Ù‚Ù‘Øª</title>
<style>
body{
  font-family: Arial, sans-serif;
  background:#111;
  color:#fff;
  margin:0;
  padding:0;
  text-align:center;
}
.top-bar{
  background:#000;
  padding:10px;
  font-size:18px;
  display:flex;
  justify-content:space-around;
}
.screen{ display:none; padding:20px; }
.screen.active{ display:block; }

button{
  padding:12px 20px;
  margin:10px;
  font-size:16px;
  cursor:pointer;
}
.options button{
  display:block;
  width:80%;
  margin:10px auto;
}
.success{ color:#4caf50; }
.error{ color:#f44336; }
.timer{ color:#ff9800; }
</style>
</head>

<body>

<div class="top-bar">
  â­ Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span>
  â± Ø§Ù„ÙˆÙ‚Øª: <span id="timer">0</span>
</div>

<!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<div id="menu" class="screen active">
  <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h1>
  <button id="stage1Btn">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1</button>
  <button id="stage2Btn">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 ğŸ”’</button>
  <button id="stage3Btn">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3 ğŸ”’</button>
</div>

<!-- Ø§Ù„Ù„Ø¹Ø¨Ø© -->
<div id="game" class="screen">
  <h2 id="stageTitle"></h2>
  <p id="question"></p>
  <div class="options" id="options"></div>
  <p id="result"></p>
</div>

<script>
// ========= Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =========
const stages = {
  1: [
    { q: "2 + 2 = ØŸ", options: ["3","4","5"], answer: 1 },
    { q: "Ù„ÙˆÙ† Ø§Ù„Ø³Ù…Ø§Ø¡ØŸ", options: ["Ø£Ø²Ø±Ù‚","Ø£Ø®Ø¶Ø±","Ø£Ø­Ù…Ø±"], answer: 0 }
  ],
  2: [
    { q: "Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ù…ØºØ±Ø¨ØŸ", options: ["Ø§Ù„Ø±Ø¨Ø§Ø·","ÙØ§Ø³","Ù…Ø±Ø§ÙƒØ´"], answer: 0 },
    { q: "Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ", options: ["6","7","8"], answer: 1 }
  ],
  3: [
    { q: "âˆš16 = ØŸ", options: ["3","4","5"], answer: 1 },
    { q: "Ø£ÙƒØ¨Ø± Ù‚Ø§Ø±Ø©ØŸ", options: ["Ø¥ÙØ±ÙŠÙ‚ÙŠØ§","Ø¢Ø³ÙŠØ§","Ø£ÙˆØ±ÙˆØ¨Ø§"], answer: 1 }
  ]
};

const stageTime = { 1:10, 2:8, 3:6 };

let currentStage = 1;
let currentQuestion = 0;
let timeLeft = 0;
let timerInterval = null;

// ========= Ø§Ù„ØªÙ‚Ø¯Ù… =========
let unlockedStage = parseInt(localStorage.getItem("unlockedStage")) || 1;
let score = parseInt(localStorage.getItem("score")) || 0;

const scoreEl = document.getElementById("score");
const timerEl = document.getElementById("timer");
scoreEl.innerText = score;

// ========= Ø¹Ù†Ø§ØµØ± =========
const menu = document.getElementById("menu");
const game = document.getElementById("game");
const stageTitle = document.getElementById("stageTitle");
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const resultEl = document.getElementById("result");

const stage1Btn = document.getElementById("stage1Btn");
const stage2Btn = document.getElementById("stage2Btn");
const stage3Btn = document.getElementById("stage3Btn");

// ========= ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„ =========
function updateMenu(){
  if(unlockedStage >= 2) stage2Btn.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2";
  if(unlockedStage >= 3) stage3Btn.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3";
}
updateMenu();

// ========= Ø¨Ø¯Ø¡ Ù…Ø±Ø­Ù„Ø© =========
function startStage(stage){
  if(stage > unlockedStage) return;
  currentStage = stage;
  currentQuestion = 0;
  menu.classList.remove("active");
  game.classList.add("active");
  stageTitle.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + stage;
  showQuestion();
}

// ========= Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª =========
function startTimer(){
  clearInterval(timerInterval);
  timeLeft = stageTime[currentStage];
  timerEl.innerText = timeLeft;

  timerInterval = setInterval(()=>{
    timeLeft--;
    timerEl.innerText = timeLeft;
    if(timeLeft <= 0){
      clearInterval(timerInterval);
      resultEl.innerText = "â± Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª";
      resultEl.className = "error";
      currentQuestion++;
      setTimeout(nextStep,700);
    }
  },1000);
}

// ========= Ø¹Ø±Ø¶ Ø³Ø¤Ø§Ù„ =========
function showQuestion(){
  const q = stages[currentStage][currentQuestion];
  questionEl.innerText = q.q;
  optionsEl.innerHTML = "";
  resultEl.innerText = "";
  startTimer();

  q.options.forEach((opt,i)=>{
    const btn = document.createElement("button");
    btn.innerText = opt;
    btn.onclick = ()=>checkAnswer(i);
    optionsEl.appendChild(btn);
  });
}

// ========= ØªØ­Ù‚Ù‚ =========
function checkAnswer(i){
  clearInterval(timerInterval);
  const q = stages[currentStage][currentQuestion];

  if(i === q.answer){
    let add = currentStage === 1 ? 10 : currentStage === 2 ? 15 : 20;
    score += add;
    localStorage.setItem("score", score);
    scoreEl.innerText = score;
    resultEl.innerText = "âœ” ØµØ­ÙŠØ­ (+"+add+")";
    resultEl.className = "success";
  }else{
    resultEl.innerText = "âœ– Ø®Ø·Ø£";
    resultEl.className = "error";
  }
  currentQuestion++;
  setTimeout(nextStep,700);
}

// ========= Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ =========
function nextStep(){
  if(currentQuestion < stages[currentStage].length){
    showQuestion();
  }else{
    finishStage();
  }
}

// ========= Ù†Ù‡Ø§ÙŠØ© Ù…Ø±Ø­Ù„Ø© =========
function finishStage(){
  clearInterval(timerInterval);
  if(unlockedStage === currentStage && currentStage < 3){
    unlockedStage++;
    localStorage.setItem("unlockedStage", unlockedStage);
  }
  alert("ğŸ‰ Ø£Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + currentStage);
  game.classList.remove("active");
  menu.classList.add("active");
  updateMenu();
}

// ========= Ø£Ø²Ø±Ø§Ø± =========
stage1Btn.onclick = ()=>startStage(1);
stage2Btn.onclick = ()=>startStage(2);
stage3Btn.onclick = ()=>startStage(3);
</script>

</body>
</html>
