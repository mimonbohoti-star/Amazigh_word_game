<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لعبة الكلمات الأمازيغية</title>

<style>
body {
  margin: 0;
  font-family: Tahoma, Arial, sans-serif;
  background: #0f172a;
  color: #fff;
  text-align: center;
}

.hidden { display: none !important; }

button {
  padding: 10px 14px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #22c55e;
  color: #000;
  cursor: pointer;
}

.start-screen, .menu, .game {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.flag-symbol {
  font-size: 80px;
  margin-bottom: 20px;
}

.level-box {
  background: #1e293b;
  padding: 20px;
  border-radius: 12px;
  width: 95%;
  max-width: 420px;
}

.word {
  font-size: 26px;
  margin: 10px 0;
  letter-spacing: 2px;
  direction: ltr;
}

/* مؤشر التقدم */
.progress {
  font-size: 14px;
  color: #cbd5f5;
  margin-bottom: 6px;
}

/* مربعات الجواب */
.answer-boxes {
  display: flex;
  justify-content: center;
  gap: 6px;
  margin: 10px 0 14px;
  direction: ltr;
}

.answer-box {
  width: 42px;
  height: 42px;
  border-radius: 6px;
  background: #e5e7eb;
  color: #000;
  font-size: 22px;
  line-height: 42px;
  font-weight: bold;
}

.correct {
  background: #22c55e !important;
}

.wrong {
  background: #ef4444 !important;
}

/* لوحة الحروف */
.keyboard {
  margin-top: 12px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 6px;
}

.keyboard button {
  background: #334155;
  color: #fff;
  min-width: 42px;
}

.delete {
  background: #ef4444 !important;
}

.message {
  margin-top: 12px;
  min-height: 24px;
}
</style>
</head>

<body>

<div class="start-screen" id="startScreen">
  <div class="flag-symbol">ⵣ</div>
  <button onclick="showMenu()">ابدأ</button>
</div>

<div class="menu hidden" id="menu">
  <h2>اختر المرحلة</h2>
  <button onclick="startLevel(1)">المرحلة 1</button><br><br>
  <button onclick="startLevel(2)">المرحلة 2</button><br><br>
  <button onclick="startLevel(3)">المرحلة 3</button>
</div>

<div class="game hidden" id="game">
  <div class="level-box">
    <h3 id="levelTitle"></h3>
    <div class="progress" id="progress"></div>
    <div class="word" id="question"></div>

    <div class="answer-boxes" id="answerBoxes"></div>

    <div class="keyboard" id="keyboard"></div>

    <br>
    <button onclick="checkAnswer()">تحقق</button>
    <div class="message" id="message"></div>
    <br>
    <button onclick="showMenu()">الرجوع للقائمة</button>
  </div>
</div>

<script>
const levels = {
  1: [
    { q: "SUN", a: "ⵜⴰⴼⵓⵢⵜ" },
    { q: "WATER", a: "ⴰⵎⴰⵏ" },
    { q: "FIRE", a: "ⵜⵉⵙⵉ" }
  ],
  2: [
    { q: "MOON", a: "ⴰⵢⵓⵔ" },
    { q: "STAR", a: "ⵉⵜⵔⵉ" },
    { q: "EARTH", a: "ⴰⴽⴰⵍ" }
  ],
  3: [
    { q: "MOUNTAIN", a: "ⴰⴷⵔⴰⵔ" },
    { q: "WIND", a: "ⴰⴼⴰⵙ" },
    { q: "RAIN", a: "ⴰⵏⵣⴰⵔ" }
  ]
};

const letters = ["ⴰ","ⴱ","ⴳ","ⴷ","ⴹ","ⴻ","ⴼ","ⴽ","ⵉ","ⵍ","ⵎ","ⵏ","ⵔ","ⵙ","ⵜ","ⵓ","ⵢ","ⵣ"];

let currentLevel = 1;
let currentIndex = 0;
let userAnswer = "";

function hideAll() {
  startScreen.classList.add("hidden");
  menu.classList.add("hidden");
  game.classList.add("hidden");
}

function showMenu() {
  hideAll();
  menu.classList.remove("hidden");
}

function startLevel(level) {
  currentLevel = level;
  currentIndex = 0;
  hideAll();
  game.classList.remove("hidden");
  levelTitle.innerText = "المرحلة " + level;
  loadQuestion();
}

function loadQuestion() {
  const answer = levels[currentLevel][currentIndex].a;
  question.innerText = levels[currentLevel][currentIndex].q;
  progress.innerText =
    "سؤال " + (currentIndex + 1) + " / " + levels[currentLevel].length;

  message.innerText = "";
  userAnswer = "";
  buildAnswerBoxes(answer.length);
  buildKeyboard();
}

function buildAnswerBoxes(len) {
  answerBoxes.innerHTML = "";
  for (let i = 0; i < len; i++) {
    const box = document.createElement("div");
    box.className = "answer-box";
    answerBoxes.appendChild(box);
  }
}

function updateBoxes() {
  const boxes = document.querySelectorAll(".answer-box");
  boxes.forEach((b, i) => {
    b.textContent = userAnswer[i] || "";
    b.classList.remove("correct","wrong");
  });
}

function buildKeyboard() {
  keyboard.innerHTML = "";

  letters.forEach(l => {
    const b = document.createElement("button");
    b.textContent = l;
    b.onclick = () => {
      if (userAnswer.length < answerBoxes.children.length) {
        userAnswer += l;
        updateBoxes();
      }
    };
    keyboard.appendChild(b);
  });

  const del = document.createElement("button");
  del.textContent = "⌫";
  del.className = "delete";
  del.onclick = () => {
    userAnswer = userAnswer.slice(0, -1);
    updateBoxes();
  };
  keyboard.appendChild(del);
}

function checkAnswer() {
  const correct = levels[currentLevel][currentIndex].a;
  const boxes = document.querySelectorAll(".answer-box");

  if (userAnswer === correct) {
    boxes.forEach(b => b.classList.add("correct"));
    message.innerText = "✔️ أحسنت";

    setTimeout(() => {
      currentIndex++;
      if (currentIndex < levels[currentLevel].length) {
        loadQuestion();
      } else {
        message.innerText = "✔️ انتهت المرحلة";
      }
    }, 600);
  } else {
    boxes.forEach(b => b.classList.add("wrong"));
    message.innerText = "❌ حاول مرة أخرى";
  }
}

window.onload = () => {
  hideAll();
  startScreen.classList.remove("hidden");
};
</script>

</body>
</html>
