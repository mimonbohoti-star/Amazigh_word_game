<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>âµ£ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{--accent:#facc15}
body{
 margin:0;font-family:sans-serif;
 background:radial-gradient(circle at top,#1e293b,#020617);
 color:#fff;display:flex;justify-content:center;align-items:center;min-height:100vh;
}
.card{
 width:95%;max-width:420px;background:#020617;border-radius:26px;
 padding:22px;box-shadow:0 0 0 2px var(--accent),0 30px 60px rgba(0,0,0,.7);
}
h1{text-align:center;color:var(--accent)}
.section{display:none}
.section.active{display:block}

.btn{
 width:100%;min-height:52px;margin:8px 0;border:none;border-radius:16px;
 font-size:18px;font-weight:700;cursor:pointer
}
.btn-main{background:var(--accent);color:#000}
.btn-ok{background:#22c55e;color:#000}
.btn-back{background:#0f172a;color:#fff;border:1px solid #334155}
.btn-del{background:#ef4444;color:#fff}

.map{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.stage{
 background:#111827;border-radius:16px;padding:20px;text-align:center;
 font-weight:bold
}
.stage.locked{opacity:.3}
.stage.active{background:var(--accent);color:#000;cursor:pointer}

.answer-boxes{
 display:flex;justify-content:center;gap:8px;margin:12px 0;
 direction:ltr;
}
.answer-box{
 width:44px;height:44px;border-radius:10px;background:#fff;color:#000;
 display:flex;align-items:center;justify-content:center;font-size:22px
}
.answer-box.ok{background:#22c55e}
.answer-box.bad{background:#ef4444;color:#fff}

.keyboard{
 display:grid;grid-template-columns:repeat(6,1fr);gap:8px;
 direction:ltr;
}
.key{
 background:#1e293b;padding:12px;border-radius:12px;
 text-align:center;font-size:20px;cursor:pointer
}
.key.used{opacity:.3;pointer-events:none}

.wheel{
 width:260px;height:260px;margin:20px auto;
 border-radius:50%;border:3px solid var(--accent);
 position:relative;direction:ltr
}
.wheel .key{
 width:52px;height:52px;border-radius:50%;
 background:var(--accent);color:#000;
 position:absolute;display:flex;
 align-items:center;justify-content:center;
 font-weight:bold
}

.overlay{
 position:fixed;inset:0;background:rgba(0,0,0,.95);
 display:none;justify-content:center;align-items:center
}
.overlay.active{display:flex}
.win{
 background:#020617;padding:28px;border-radius:24px;
 box-shadow:0 0 60px var(--accent);
 animation:pulse .6s infinite alternate
}
@keyframes pulse{
 from{box-shadow:0 0 20px var(--accent)}
 to{box-shadow:0 0 80px #fff}
}
</style>
</head>

<body>

<div class="card">

<div id="menu" class="section active">
 <h1>âµ£ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</h1>
 <button class="btn btn-main" onclick="openMap()">â–¶ï¸ Ø¨Ø¯Ø¡</button>
</div>

<div id="map" class="section">
 <h1>â­ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</h1>
 <div class="map" id="mapGrid"></div>
 <button class="btn btn-back" onclick="show('menu')">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
</div>

<div id="game" class="section">
 <h1 id="levelTitle"></h1>
 <div id="question"></div>
 <div class="answer-boxes" id="boxes"></div>
 <div id="wheel" class="wheel"></div>
 <div id="keyboard" class="keyboard"></div>

 <button class="btn btn-del" onclick="del()">âŒ« Ø­Ø°Ù</button>
 <button class="btn btn-ok" onclick="check()">âœ”ï¸ ØªØ£ÙƒÙŠØ¯</button>
</div>

</div>

<div id="overlay" class="overlay">
 <div class="win">
  <h2>ğŸ”¥ Ø£Ø­Ø³Ù†Øª ğŸ”¥</h2>
  <button class="btn btn-main" onclick="next()">â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
 </div>
</div>

<script>
const levels=[
 {img:"images/sun.jpg",a:"âµœâ´°â´¼âµ“âµ¢âµœ",c:"#facc15"},
 {img:"images/moon.jpg",a:"â´°âµ¢âµ“âµ”",c:"#60a5fa"},
 {img:"images/stars.jpg",a:"âµ‰âµœâµ”â´°âµ",c:"#e9d5ff"},
 {img:"images/mountain.jpg",a:"â´°â´·âµ”â´°âµ”",c:"#34d399"},
 {img:"images/river.jpg",a:"â´°âµ™âµ‰â´¼",c:"#38bdf8"},
 {img:"images/cactus.jpg",a:"â´°â´³â´°â´¼â´°âµ¢",c:"#4ade80"},
 {img:"images/flower.jpg",a:"âµœâ´°âµ£âµ“âµ”âµ‰âµœ",c:"#fb7185"},
 {img:"images/insect.jpg",a:"âµœâ´°âµ£âµ£âµ“âµâµœ",c:"#f97316"}
];

let unlocked=+localStorage.getItem("amazighUnlocked")||0;
let cur=0,input=[];

function show(id){
 document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
}

function openMap(){
 mapGrid.innerHTML="";
 levels.forEach((_,i)=>{
  let d=document.createElement("div");
  d.className="stage"+(i>unlocked?" locked":" active");
  d.innerText="Ù…Ø±Ø­Ù„Ø© "+(i+1);
  if(i<=unlocked)d.onclick=()=>start(i);
  mapGrid.appendChild(d);
 });
 show("map");
}

function start(i){
 cur=i;input=[];
 document.documentElement.style.setProperty("--accent",levels[i].c);
 levelTitle.innerText="Ø§Ù„Ù…Ø±Ø­Ù„Ø© "+(i+1);
 question.innerHTML=`<img src="${levels[i].img}" width="100%">`;
 boxes.innerHTML="";wheel.innerHTML="";keyboard.innerHTML="";
 [...levels[i].a].forEach(()=>boxes.innerHTML+=`<div class="answer-box"></div>`);

 wheel.style.display="none";keyboard.style.display="grid";
 [...levels[i].a].sort(()=>Math.random()-.5).forEach(ch=>{
  let k=document.createElement("div");
  k.className="key";k.innerText=ch;
  k.onclick=()=>add(ch,k);
  keyboard.appendChild(k);
 });
 show("game");
}

function add(ch,key){
 if(input.length<levels[cur].a.length){
  input.push({ch,key});
  key.classList.add("used");
  refresh();
 }
}

function del(){
 if(!input.length) return;
 let last=input.pop();
 last.key.classList.remove("used");
 refresh();
}

function refresh(){
 document.querySelectorAll(".answer-box").forEach((b,i)=>{
  b.classList.remove("ok","bad");
  b.innerText=input[i]?.ch||"";
 });
}

function check(){
 let ok=input.map(o=>o.ch).join("")===levels[cur].a;
 document.querySelectorAll(".answer-box").forEach(b=>b.classList.add(ok?"ok":"bad"));
 if(ok){
  if(cur===unlocked){unlocked++;localStorage.setItem("amazighUnlocked",unlocked)}
  overlay.classList.add("active");
 }
}

function next(){
 overlay.classList.remove("active");
 cur+1<levels.length?start(cur+1):show("menu");
}
</script>

</body>
</html>
