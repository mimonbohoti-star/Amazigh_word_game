<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>شبكة السحب</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: linear-gradient(#0f3d3d, #4fa3a3);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.grid {
  display: grid;
  grid-template-columns: repeat(7, 46px);
  gap: 8px;
  touch-action: none;
}

.cell {
  width: 46px;
  height: 46px;
  background: #1e2f2f;
  border-radius: 8px;
}

.cell.active {
  background: #5ecbff;
}
</style>
</head>

<body>

<div class="grid" id="grid"></div>

<script>
const grid = document.getElementById("grid");
const size = 7;
const cells = [];
let isDragging = false;
let startIndex = null;
let direction = null;

// إنشاء الشبكة
for (let i = 0; i < size * size; i++) {
  const cell = document.createElement("div");
  cell.className = "cell";
  cell.dataset.index = i;
  grid.appendChild(cell);
  cells.push(cell);
}

function getRow(i) { return Math.floor(i / size); }
function getCol(i) { return i % size; }

function clearSelection() {
  cells.forEach(c => c.classList.remove("active"));
}

grid.addEventListener("pointerdown", e => {
  const target = e.target;
  if (!target.classList.contains("cell")) return;

  clearSelection();
  isDragging = true;
  startIndex = +target.dataset.index;
  direction = null;
  target.classList.add("active");
});

grid.addEventListener("pointermove", e => {
  if (!isDragging) return;

  const el = document.elementFromPoint(e.clientX, e.clientY);
  if (!el || !el.classList.contains("cell")) return;

  const currentIndex = +el.dataset.index;

  const sr = getRow(startIndex);
  const sc = getCol(startIndex);
  const cr = getRow(currentIndex);
  const cc = getCol(currentIndex);

  if (!direction) {
    if (sr === cr) direction = "row";
    else if (sc === cc) direction = "col";
    else return;
  }

  clearSelection();

  if (direction === "row" && sr === cr) {
    const min = Math.min(sc, cc);
    const max = Math.max(sc, cc);
    for (let c = min; c <= max; c++) {
      cells[sr * size + c].classList.add("active");
    }
  }

  if (direction === "col" && sc === cc) {
    const min = Math.min(sr, cr);
    const max = Math.max(sr, cr);
    for (let r = min; r <= max; r++) {
      cells[r * size + sc].classList.add("active");
    }
  }
});

window.addEventListener("pointerup", () => {
  isDragging = false;
  startIndex = null;
  direction = null;
});
</script>

</body>
</html>
