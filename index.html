<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Tahoma, Arial, sans-serif;
  background: #0f0f0f;
  color: #fff;
  text-align: center;
}

.stage {
  padding: 30px 15px;
}

.word-box {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 30px 0;
  direction: ltr;
}

.letter {
  width: 55px;
  height: 65px;
  font-size: 30px;
  text-align: center;
  border-radius: 10px;
  border: 2px solid #444;
  background: #1c1c1c;
  color: #fff;
}

.correct {
  border-color: #2ecc71;
  background: #1e7e34;
}

.wrong {
  border-color: #e74c3c;
  background: #922b21;
}

.word-box.shake {
  animation: shake 0.4s;
}

@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-6px); }
  50% { transform: translateX(6px); }
  75% { transform: translateX(-6px); }
  100% { transform: translateX(0); }
}

button {
  margin-top: 20px;
  padding: 12px 28px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #3498db;
  color: #fff;
  cursor: pointer;
  opacity: 0.5;
}

button.enabled {
  opacity: 1;
}

button:disabled {
  cursor: not-allowed;
}
</style>
</head>

<body>

<div class="stage">
  <h2 id="levelInfo"></h2>

  <div class="word-box" id="wordBox"></div>

  <div id="message">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©</div>

  <button id="nextBtn" onclick="nextLevel()" disabled>
    Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
  </button>
</div>

<script>
const levels = [
  { answer: "AZUL" },
  { answer: "AMUR" },
  { answer: "TAFSUT" }
];

let currentLevel = Number(localStorage.getItem("amazighLevel")) || 0;
let inputs = [];

const nextBtn = document.getElementById("nextBtn");

function loadLevel() {
  const wordBox = document.getElementById("wordBox");
  wordBox.innerHTML = "";
  inputs = [];

  nextBtn.disabled = true;
  nextBtn.classList.remove("enabled");

  document.getElementById("message").textContent = "Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©";
  document.getElementById("levelInfo").textContent =
    "Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + (currentLevel + 1);

  const answer = levels[currentLevel].answer;

  for (let i = 0; i < answer.length; i++) {
    const input = document.createElement("input");
    input.maxLength = 1;
    input.className = "letter";

    input.addEventListener("input", () => handleInput(i));
    input.addEventListener("keydown", e => handleBackspace(e, i));

    inputs.push(input);
    wordBox.appendChild(input);
  }

  inputs[0].focus();
}

function handleInput(index) {
  inputs[index].value = inputs[index].value.toUpperCase();

  if (inputs[index].value && index < inputs.length - 1) {
    inputs[index + 1].focus();
  }

  checkWord();
}

function handleBackspace(e, index) {
  if (e.key === "Backspace" && !inputs[index].value && index > 0) {
    inputs[index - 1].focus();
  }
}

function resetStyles() {
  inputs.forEach(i => i.classList.remove("correct", "wrong"));
}

function checkWord() {
  const answer = levels[currentLevel].answer;
  const userWord = inputs.map(i => i.value).join("");

  if (userWord.length < answer.length) return;

  resetStyles();

  if (userWord === answer) {
    inputs.forEach(i => i.classList.add("correct"));
    document.getElementById("message").textContent = "âœ” Ø¬ÙˆØ§Ø¨ ØµØ­ÙŠØ­";

    nextBtn.disabled = false;
    nextBtn.classList.add("enabled");

    localStorage.setItem("amazighLevel", currentLevel + 1);
  } else {
    inputs.forEach(i => i.classList.add("wrong"));
    const box = document.getElementById("wordBox");
    box.classList.add("shake");
    setTimeout(() => box.classList.remove("shake"), 400);

    document.getElementById("message").textContent = "âœ– Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";
  }
}

function nextLevel() {
  if (currentLevel < levels.length - 1) {
    currentLevel++;
    loadLevel();
  } else {
    document.getElementById("message").textContent = "ðŸŽ‰ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„";
    nextBtn.disabled = true;
  }
}

loadLevel();
</script>

</body>
</html>
